<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modern Multi-Tool Calculator</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa7b2;--accent:#6ee7b7;--glass:rgba(255,255,255,0.04)}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Segoe UI,system-ui,Arial;background:linear-gradient(180deg,#071021 0%, #07172a 60%);color:#e6eef6}
    .wrap{max-width:1100px;margin:28px auto;padding:20px;display:grid;grid-template-columns:1fr 360px;gap:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-radius:12px;padding:18px;box-shadow:0 6px 22px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;gap:12px;align-items:center;margin-bottom:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#60a5fa);display:grid;place-items:center;font-weight:700;color:#042022}
    h1{font-size:18px;margin:0}
    p.sub{margin:0;font-size:13px;color:var(--muted)}

    /* Tabs */
    .tabs{display:flex;gap:6px;margin:8px 0 14px}
    .tab{padding:8px 12px;border-radius:10px;background:var(--glass);cursor:pointer;font-weight:600;color:var(--muted);border:1px solid rgba(255,255,255,0.02)}
    .tab.active{background:linear-gradient(90deg, rgba(110,231,183,0.08), rgba(96,165,250,0.06));color:var(--accent);box-shadow:inset 0 -2px 0 rgba(255,255,255,0.02)}

    /* Calculator grid */
    .calc-display{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;text-align:right;font-size:28px;min-height:58px;display:flex;flex-direction:column;justify-content:center}
    .calc-sub{font-size:14px;color:var(--muted)}
    .buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px}
    button.key{padding:14px;border-radius:10px;border:0;background:rgba(255,255,255,0.03);font-weight:700;color:#e8f7f0;cursor:pointer}
    button.key.op{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
    button.key.equal{grid-column:span 2;background:linear-gradient(90deg,var(--accent),#60a5fa);color:#042022}

    /* Right column */
    .side .section{margin-bottom:12px}
    .history{max-height:360px;overflow:auto;padding:10px;background:rgba(255,255,255,0.02);border-radius:10px}
    .history p{margin:8px 0;font-size:14px;color:var(--muted)}
    .row{display:flex;gap:8px;align-items:center}
    input[type="number"], input[type="date"], select, input[type="text"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
    .muted{color:var(--muted);font-size:13px}

    /* responsive */
    @media (max-width:900px){.wrap{grid-template-columns:1fr;max-width:720px}.side{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <main class="card">
      <header>
        <div class="logo">C</div>
        <div>
          <h1>Modern Multi-Tool Calculator</h1>
          <p class="sub">Basic · Scientific · BMI · Age · Currency · Percentage</p>
        </div>
      </header>

      <div class="tabs" id="tabs">
        <div class="tab active" data-tab="basic">Basic</div>
        <div class="tab" data-tab="scientific">Scientific</div>
        <div class="tab" data-tab="bmi">BMI</div>
        <div class="tab" data-tab="age">Age</div>
        <div class="tab" data-tab="currency">Currency</div>
        <div class="tab" data-tab="percentage">Percentage</div>
      </div>

      <!-- Basic & Scientific shared area -->
      <section id="basic" class="panel">
        <div class="calc-display" id="display">
          <div class="calc-sub" id="sub">0</div>
          <div id="main">0</div>
        </div>
        <div class="buttons" id="keys">
          <button class="key" data-val="7">7</button>
          <button class="key" data-val="8">8</button>
          <button class="key" data-val="9">9</button>
          <button class="key op" data-val="/">÷</button>

          <button class="key" data-val="4">4</button>
          <button class="key" data-val="5">5</button>
          <button class="key" data-val="6">6</button>
          <button class="key op" data-val="*">×</button>

          <button class="key" data-val="1">1</button>
          <button class="key" data-val="2">2</button>
          <button class="key" data-val="3">3</button>
          <button class="key op" data-val="-">−</button>

          <button class="key" data-val="0">0</button>
          <button class="key" data-val=".">.</button>
          <button class="key equal" id="equal">=</button>
          <button class="key op" data-val="+">+</button>

          <!-- scientific row (visible only when tab scientific is active) -->
          <button class="key sci" data-fn="sin">sin</button>
          <button class="key sci" data-fn="cos">cos</button>
          <button class="key sci" data-fn="tan">tan</button>
          <button class="key sci" data-fn="sqrt">√</button>

          <button class="key sci" data-fn="pow">xʸ</button>
          <button class="key sci" data-fn="log">log</button>
          <button class="key sci" data-fn="pi">π</button>
          <button class="key" id="clear">C</button>
        </div>
      </section>

      <!-- BMI panel -->
      <section id="bmi" class="panel" style="display:none">
        <div class="row" style="gap:12px;margin-bottom:10px">
          <div style="flex:1"><label class="muted">Weight (kg)</label><input id="bmi-weight" type="number" min="1" step="0.1" value="70"></div>
          <div style="flex:1"><label class="muted">Height (cm)</label><input id="bmi-height" type="number" min="30" step="0.1" value="170"></div>
        </div>
        <div style="display:flex;gap:10px;align-items:center"><button id="bmi-calc" class="key">Calculate BMI</button><div id="bmi-out" class="muted">Result will appear here</div></div>
      </section>

      <!-- Age panel -->
      <section id="age" class="panel" style="display:none">
        <div class="row" style="gap:12px;margin-bottom:10px">
          <div style="flex:1"><label class="muted">Date of birth</label><input id="dob" type="date"></div>
        </div>
        <div style="display:flex;gap:10px;align-items:center;margin-top:8px"><button id="age-calc" class="key">Calculate Age</button><div id="age-out" class="muted">Age will appear here</div></div>
      </section>

      <!-- Currency panel -->
      <section id="currency" class="panel" style="display:none">
        <div class="row" style="gap:8px;margin-bottom:8px">
          <div style="flex:1"><label class="muted">Amount</label><input id="cur-amt" type="number" value="1" step="any"></div>
          <div style="flex:1"><label class="muted">From</label><select id="cur-from"></select></div>
          <div style="flex:1"><label class="muted">To</label><select id="cur-to"></select></div>
        </div>
        <div style="display:flex;gap:10px;align-items:center"><button id="cur-convert" class="key">Convert (online)</button><div id="cur-out" class="muted">Rates fetched from public API</div></div>
      </section>

      <!-- Percentage panel -->
      <section id="percentage" class="panel" style="display:none">
        <div class="row" style="gap:8px;margin-bottom:8px">
          <div style="flex:1"><label class="muted">Base value</label><input id="pct-base" type="number" value="100"></div>
          <div style="flex:1"><label class="muted">Percentage (%)</label><input id="pct-pct" type="number" value="15"></div>
        </div>
        <div style="display:flex;gap:10px;align-items:center"><button id="pct-calc" class="key">Calculate</button><div id="pct-out" class="muted">Result</div></div>
      </section>

    </main>

    <aside class="card side">
      <div class="section">
        <h3 style="margin:0 0 8px 0">History</h3>
        <div class="history" id="history">
          <p class="muted">No calculations yet.</p>
        </div>
      </div>

      <div class="section">
        <h3 style="margin:0 0 8px 0">Settings</h3>
        <p class="muted">Angle mode</p>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="deg" class="key">DEG</button>
          <button id="rad" class="key">RAD</button>
        </div>
      </div>

      <div class="section">
        <h3 style="margin:0 0 8px 0">Quick tips</h3>
        <p class="muted">Use xʸ for power. Currency uses exchangerate.host (free) when online.</p>
      </div>
    </aside>
  </div>

  <script>
    // Tab logic
    document.querySelectorAll('.tab').forEach(t=>t.addEventListener('click', ()=>{
      document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      const tabs = ['basic','scientific','bmi','age','currency','percentage'];
      tabs.forEach(name=>{
        const el = document.getElementById(name);
        el.style.display = (name===t.dataset.tab|| (name==='basic' && t.dataset.tab==='scientific'))? 'block' : 'none';
      });
      // show/hide scientific keys
      const sciKeys = document.querySelectorAll('.sci');
      sciKeys.forEach(k=>k.style.display = (t.dataset.tab==='scientific')? 'inline-block' : 'none');
    }));

    // Basic calculator state
    let expr = '';
    const main = document.getElementById('main');
    const sub = document.getElementById('sub');
    const history = document.getElementById('history');

    function pushHistory(text){
      const p = document.createElement('p'); p.textContent = text; p.className='muted';
      history.insertBefore(p, history.firstChild);
    }

    document.getElementById('keys').addEventListener('click', (e)=>{
      const b = e.target.closest('button'); if(!b) return;
      const val = b.dataset.val;
      const fn = b.dataset.fn;
      if(val!==undefined){ expr += val; main.textContent = expr || '0'; sub.textContent = expr; }
      if(fn){ applySci(fn); }
      if(b.id==='clear'){ expr=''; main.textContent='0'; sub.textContent='0'; }
    });

    document.getElementById('equal').addEventListener('click', ()=>{ compute(); });

    function safeEval(s){
      // allow digits, operators, parentheses, dot
      if(/[^0-9+\-*/(). %eE]/.test(s)) throw 'Invalid characters';
      // replace unicode division/multiplication if any
      s = s.replace(/÷/g,'/').replace(/×/g,'*');
      // evaluated using Function (minimal wrapper)
      return Function('return ('+s+')')();
    }

    function compute(){
      try{
        if(!expr) return;
        const result = safeEval(expr);
        pushHistory(expr + ' = ' + result);
        sub.textContent = expr + ' =';
        main.textContent = String(result);
        expr = String(result);
      }catch(err){ main.textContent='Error'; pushHistory('Error evaluating: '+expr); expr=''; }
    }

    // scientific functions
    let angleMode = 'deg';
    document.getElementById('deg').addEventListener('click', ()=>{ angleMode='deg'; document.getElementById('deg').style.opacity=1; document.getElementById('rad').style.opacity=0.7; });
    document.getElementById('rad').addEventListener('click', ()=>{ angleMode='rad'; document.getElementById('rad').style.opacity=1; document.getElementById('deg').style.opacity=0.7; });

    function toRad(v){ return angleMode==='deg' ? v * Math.PI/180 : v; }

    function applySci(fn){
      try{
        if(fn==='pi'){ expr += String(Math.PI); main.textContent=expr; return; }
        if(!expr){ sub.textContent='0'; return; }
        let val = safeEval(expr);
        let out;
        switch(fn){
          case 'sin': out = Math.sin(toRad(val)); break;
          case 'cos': out = Math.cos(toRad(val)); break;
          case 'tan': out = Math.tan(toRad(val)); break;
          case 'sqrt': out = Math.sqrt(val); break;
          case 'pow': expr += '**'; main.textContent = expr; return;
          case 'log': out = Math.log10 ? Math.log10(val) : Math.log(val)/Math.LN10; break;
          default: out = val;
        }
        pushHistory(fn + '('+val+') = ' + out);
        main.textContent = out;
        sub.textContent = fn + '('+val+') =';
        expr = String(out);
      }catch(e){ main.textContent='Error'; expr=''; }
    }

    // BMI
    document.getElementById('bmi-calc').addEventListener('click', ()=>{
      const w = parseFloat(document.getElementById('bmi-weight').value);
      const hcm = parseFloat(document.getElementById('bmi-height').value);
      if(!w||!hcm){ document.getElementById('bmi-out').textContent='Enter weight & height'; return; }
      const h = hcm/100; const bmi = w/(h*h);
      let cat='';
      if(bmi<18.5) cat='Underweight'; else if(bmi<25) cat='Normal'; else if(bmi<30) cat='Overweight'; else cat='Obese';
      const out = 'BMI: '+bmi.toFixed(2)+' — '+cat;
      document.getElementById('bmi-out').textContent = out;
      pushHistory('BMI -> '+out);
    });

    // Age
    document.getElementById('age-calc').addEventListener('click', ()=>{
      const d = document.getElementById('dob').value; if(!d){ document.getElementById('age-out').textContent='Pick a date'; return; }
      const dob = new Date(d); const now = new Date(); if(dob>now){ document.getElementById('age-out').textContent='Date in future'; return; }
      let years = now.getFullYear() - dob.getFullYear();
      let months = now.getMonth() - dob.getMonth();
      let days = now.getDate() - dob.getDate();
      if(days<0){ months--; days += new Date(now.getFullYear(), now.getMonth(), 0).getDate(); }
      if(months<0){ years--; months+=12; }
      const out = years+' years, '+months+' months, '+days+' days';
      document.getElementById('age-out').textContent = out; pushHistory('Age -> '+out);
    });

    // Percentage
    document.getElementById('pct-calc').addEventListener('click', ()=>{
      const base = parseFloat(document.getElementById('pct-base').value);
      const pct = parseFloat(document.getElementById('pct-pct').value);
      if(isNaN(base)||isNaN(pct)){ document.getElementById('pct-out').textContent='Enter values'; return; }
      const value = base * pct / 100;
      document.getElementById('pct-out').textContent = pct + '% of ' + base + ' = ' + value;
      pushHistory('Percent -> '+pct+'% of '+base+' = '+value);
    });

    // Currency - populate common currencies
    const currencies = ['USD','EUR','GBP','INR','JPY','AUD','CAD','CNY'];
    const from = document.getElementById('cur-from'); const to = document.getElementById('cur-to');
    currencies.forEach(c=>{ from.appendChild(new Option(c,c)); to.appendChild(new Option(c,c)); });
    from.value='USD'; to.value='INR';

    document.getElementById('cur-convert').addEventListener('click', async ()=>{
      const amt = parseFloat(document.getElementById('cur-amt').value)||0;
      const f = from.value; const t = to.value;
      document.getElementById('cur-out').textContent = 'Converting...';
      try{
        // Using exchangerate.host which is free and requires no API key
        const res = await fetch('https://api.exchangerate.host/convert?from='+f+'&to='+t+'&amount='+amt);
        const j = await res.json();
        if(j && j.result!==undefined){
          document.getElementById('cur-out').textContent = amt+' '+f+' = '+j.result.toFixed(4)+' '+t;
          pushHistory('Conv: '+amt+' '+f+' -> '+j.result.toFixed(4)+' '+t);
        } else { document.getElementById('cur-out').textContent='Conversion failed (API)'; }
      }catch(err){ document.getElementById('cur-out').textContent='Network/API error — try again'; }
    });

    // initialize: hide sci keys by default
    document.querySelectorAll('.sci').forEach(k=>k.style.display='none');

    // keyboard support
    window.addEventListener('keydown', (e)=>{
      if(e.key.match(/[0-9.+\-*/()]/)) { expr += e.key; main.textContent=expr; }
      if(e.key==='Enter') compute();
      if(e.key==='Backspace'){ expr = expr.slice(0,-1); main.textContent = expr||'0'; }
    });

  </script>
</body>
</html>
